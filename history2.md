# step 2

## 리뷰 반영

~~ResponseEntity<?> 를 Void로 바꿔주기~~

xxxRequest 같은 형식으로 DTO 전부 변경하기

401 403 알바르게 사용하기

예외 이름 직관적으로 변경하기

예외 클래스를 HTTPSTATUS에 중점으로 설계하기

set 보다는 update 등으로 이름 직관적으로 변경해주기

## step 2 진도나가기

product에 giftOption을 추가하자.
반드시 하나 이상의 옵션이 있어야한다.
옵션이름 공백 포함 50글자 이하
일부 특수문자만 사용가능
옵션 수량 최소 1개 ~ 1억개 미만 -> 남아있는 옵션의 수량
동일 상품 내에 옵션 중복 불가

상품 - 옵션&상품 - 옵션

1. 컨트롤러 만들기
2. DTO 만들기
3. 서비스 & 리포지토리 만들기
4. 상품 내 중복 불허하기

## log

먼저 컨트롤러를 만들어보자.
이제 슬슬 너무 많아서 도메인별로 분류를 해야하나? 고민...

옵션 post요청? 있어야한다. 이때 유저 정보도 같이 들어와야한다?

아니지, 지금은 사용자의 구매를 진행하는 것이 아니라, 관리자의 입장에서 추가 수정 등등을 생각하자.

step3는 큰 내용이 없는 듯한 느낌?

옵션 수량 차감이 왜 하나의 step으로 분리되어있을까?

---

테스트 코드 작성하기 -> 비즈니스 예외 -> GiftException

일단 서비스부분을 먼저 테스트를 작성.

서비스는 왜 존재해야하는가?

---

서비스에서 검증해야하는 것
글자수 초과, 잘못된 특수문자 등등은 컨트롤러에서 책임을 진다고 하면, (not null 등에 대해서)

서비스에서는 검증할 필요가 없을까?

테스트...테스트...

단순히 엔티티 save가 잘 되는지 테스트는 할 필요가 없다고 생각.

의미있는 테스트.

옵션이 없는 product는 어떻게 될 것인가? 등?




## 의문

1. 컨트롤러, 서비스, 리포지토리 기본적으로 만들어주는 CRUD를 계속 새로 만들지 않고 하는 방법은 없을까?
상속? 매크로? 템플릿? 팩토리?

2. repository는 private final 이 있어야할까 없어야할까?

3. ProductService를 GiftOptionService가 주입받아서 사용하는 것 vs GiftOptionService가
전부 처리하는 것. 무엇이 더 좋은 방법일까?
일단 findById 같은 경우에는 Product서비스가 필요 없을 것 같고, product에 대한 수정? 작업만 없으면
될 것 같은 느낌이...?

4. product는 카테고리와 옵션을 항상 가지고 있어야한다. 그럼 상품을 추가할 때 무조건 카테고리와 옵션을 가지고 있어야하는가?
이들간의 순서는 어떻게 되어야할까? 한번에 동시에 추가된다면 내부에서는 어떤 순서로 이를 추가시켜야할까? 옵션은 default option을
제공할 수는 없을까?

5. @Valid의 순서가 있는가? 어노테이션 사이사이?

## 리팩토링 할 것

1. Role 이 필요한, 유저 정보가 있어야 동작할 수 있는 곳들에 member정보를 받아야한다.(권한?)
2. fetchType 제대로 설정해주기
3. 